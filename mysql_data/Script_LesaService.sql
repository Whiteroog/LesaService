-- MySQL Script generated by MySQL Workbench
-- Sat Jul 23 22:22:26 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema DB_LesaService
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `DB_LesaService` ;

-- -----------------------------------------------------
-- Schema DB_LesaService
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `DB_LesaService` DEFAULT CHARACTER SET utf8 ;
USE `DB_LesaService` ;

-- -----------------------------------------------------
-- Table `DB_LesaService`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`users` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`users` (
  `login` VARCHAR(100) NOT NULL,
  `password` VARCHAR(255) BINARY NOT NULL,
  `email` VARCHAR(100) NULL,
  `phone` VARCHAR(13) NULL,
  PRIMARY KEY (`login`),
  UNIQUE INDEX `Email_UNIQUE` (`email` ASC) VISIBLE,
  UNIQUE INDEX `Phone_UNIQUE` (`phone` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_LesaService`.`products`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`products` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`products` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(100) NOT NULL,
  `category` ENUM('Запчасть', 'Конструкция') NOT NULL,
  `product_type` VARCHAR(100) NOT NULL,
  `price` FLOAT UNSIGNED NOT NULL DEFAULT 0,
  `description` MEDIUMTEXT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `title_UNIQUE` (`title` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_LesaService`.`orders`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`orders` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`orders` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `login` VARCHAR(100) NOT NULL,
  `product_id` INT UNSIGNED NOT NULL,
  `payment_status` ENUM('Ожидайте', 'Готово', 'Забран', 'Отменен') NOT NULL,
  `order_date` DATETIME NOT NULL DEFAULT NOW(),
  `amount` INT UNSIGNED NOT NULL DEFAULT 1,
  `total_price` FLOAT UNSIGNED NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `FK_ProductFromProducts_idx` (`product_id` ASC) VISIBLE,
  CONSTRAINT `fk_users_to_orders`
    FOREIGN KEY (`login`)
    REFERENCES `DB_LesaService`.`users` (`login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_products_to_orders`
    FOREIGN KEY (`product_id`)
    REFERENCES `DB_LesaService`.`products` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_LesaService`.`parts_in_products`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`parts_in_products` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`parts_in_products` (
  `product_id` INT UNSIGNED NOT NULL,
  `part_id` INT UNSIGNED NOT NULL,
  `amount` INT UNSIGNED NOT NULL DEFAULT 1,
  UNIQUE INDEX `product_id_and_part_id_UNIQUE` (`product_id` ASC, `part_id` ASC),
  CONSTRAINT `fk_products_to_parts_in_products`
    FOREIGN KEY (`product_id`)
    REFERENCES `DB_LesaService`.`products` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_products_to_parts_in_products_part`
    FOREIGN KEY (`part_id`)
    REFERENCES `DB_LesaService`.`products` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_LesaService`.`products_parameters`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`products_parameters` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`products_parameters` (
  `id` INT UNSIGNED NOT NULL,
  `parameter` ENUM('Длина', 'Высота', 'Ширина') NOT NULL,
  `value` FLOAT UNSIGNED NOT NULL DEFAULT 0,
  INDEX `id_and_parameter_UNIQUE` (`id` ASC, `parameter` ASC) VISIBLE,
  CONSTRAINT `fk_products_to_products_parameters`
    FOREIGN KEY (`id`)
    REFERENCES `DB_LesaService`.`products` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DB_LesaService`.`parts_in_orders`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DB_LesaService`.`parts_in_orders` ;

CREATE TABLE IF NOT EXISTS `DB_LesaService`.`parts_in_orders` (
  `order_id` INT UNSIGNED NOT NULL,
  `part_id` INT UNSIGNED NOT NULL,
  `amount` INT UNSIGNED NOT NULL DEFAULT 1,
  UNIQUE INDEX `order_id_and_part_id_UNIQUE` (`order_id` ASC, `part_id` ASC),
  CONSTRAINT `fk_orders_to_parts_in_orders`
    FOREIGN KEY (`order_id`)
    REFERENCES `DB_LesaService`.`orders` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_products_to_parts_in_orders`
    FOREIGN KEY (`order_id`)
    REFERENCES `DB_LesaService`.`products` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`users`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`users` (`login`, `password`, `email`, `phone`) VALUES ('User1', '123', 'User1@gmail.com', NULL);
INSERT INTO `DB_LesaService`.`users` (`login`, `password`, `email`, `phone`) VALUES ('User2', '321', NULL, '7925765825004');

COMMIT;


-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`products`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (1, 'СЛ-001', 'Конструкция', 'Строительные леса', 100, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (2, 'СЛ-002', 'Конструкция', 'Строительные леса', 120, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (3, 'СЛ-003', 'Конструкция', 'Строительные леса', 125, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (4, 'ВТ-001', 'Конструкция', 'Вышка-тура', 60, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (5, 'ВТ-002', 'Конструкция', 'Вышка-тура', 75, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (6, 'ВТ-003', 'Конструкция', 'Вышка-тура', 90, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (7, 'Башмак', 'Запчасть', 'Опора', 2, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (8, 'Рама с лестницей', 'Запчасть', 'Рама с лестницей', 15, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (9, 'Рама проходная', 'Запчасть', 'Рама проходная', 12, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (10, 'Диагональ', 'Запчасть', 'Крепления', 5, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (11, 'Горизонталь', 'Запчасть', 'Крепления', 4, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (12, 'Ригель', 'Запчасть', 'Крепления', 3, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (13, 'Настил деревянный', 'Запчасть', 'Настил', 17, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (14, 'Башмак укрепленный', 'Запчасть', 'Опора', 4, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (15, 'Настил железный', 'Запчасть', 'Настил', 25, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (16, 'Диагональ укрепленна', 'Запчасть', 'Крепления', 7, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (17, 'База', 'Запчасть', 'Опора', 14, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (18, 'Стабилизатор', 'Запчасть', 'Опора', 30, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (19, 'Лестница секции', 'Запчасть', 'Лестница', 16, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (20, 'Гантель секции', 'Запчасть', 'Крепления', 6, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (21, 'Стяжка секции', 'Запчасть', 'Крепления', 4, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (22, 'Перекладина ограждения', 'Запчасть', 'Крепления', 4, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (23, 'Стабилизатор укрепленный', 'Запчасть', 'Опора', 40, NULL);
INSERT INTO `DB_LesaService`.`products` (`id`, `title`, `category`, `product_type`, `price`, `description`) VALUES (24, 'База на колесах', 'Запчасть', 'Опора', 19, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`orders`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`orders` (`id`, `login`, `product_id`, `payment_status`, `order_date`, `amount`, `total_price`) VALUES (1, 'User1', 1, 'Ожидайте', DEFAULT, DEFAULT, 100);
INSERT INTO `DB_LesaService`.`orders` (`id`, `login`, `product_id`, `payment_status`, `order_date`, `amount`, `total_price`) VALUES (2, 'User2', 2, 'Ожидайте', DEFAULT, DEFAULT, 120);
INSERT INTO `DB_LesaService`.`orders` (`id`, `login`, `product_id`, `payment_status`, `order_date`, `amount`, `total_price`) VALUES (3, 'User1', 3, 'Ожидайте', DEFAULT, DEFAULT, 125);
INSERT INTO `DB_LesaService`.`orders` (`id`, `login`, `product_id`, `payment_status`, `order_date`, `amount`, `total_price`) VALUES (4, 'User2', 1, 'Ожидайте', DEFAULT, DEFAULT, 100);

COMMIT;


-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`parts_in_products`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 7, 4);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 10, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (1, 13, 3);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 14, 4);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 16, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (2, 13, 3);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 14, 4);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 16, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_products` (`product_id`, `part_id`, `amount`) VALUES (3, 15, 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`products_parameters`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (1, 'Ширина', 0.7);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (1, 'Длина', 1.8);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (1, 'Высота', 1.7);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (2, 'Ширина', 0.8);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (2, 'Длина', 2);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (2, 'Высота', 1.8);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (3, 'Ширина', 0.9);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (3, 'Длина', 2.1);
INSERT INTO `DB_LesaService`.`products_parameters` (`id`, `parameter`, `value`) VALUES (3, 'Высота', 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `DB_LesaService`.`parts_in_orders`
-- -----------------------------------------------------
START TRANSACTION;
USE `DB_LesaService`;
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 7, 4);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 10, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (1, 13, 3);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 14, 4);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 16, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (2, 13, 3);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 14, 4);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 16, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (3, 15, 3);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 7, 4);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 8, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 9, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 10, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 11, 1);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 12, 2);
INSERT INTO `DB_LesaService`.`parts_in_orders` (`order_id`, `part_id`, `amount`) VALUES (4, 13, 3);

COMMIT;

